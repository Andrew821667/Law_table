# Legal AI Sheets Scripts

> Google Apps Script –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ Legal AI

[![Deploy to Production](https://github.com/Andrew821667/legal-ai-sheets-scripts/actions/workflows/deploy.yml/badge.svg)](https://github.com/Andrew821667/legal-ai-sheets-scripts/actions/workflows/deploy.yml)
[![Test & Lint](https://github.com/Andrew821667/legal-ai-sheets-scripts/actions/workflows/test.yml/badge.svg)](https://github.com/Andrew821667/legal-ai-sheets-scripts/actions/workflows/test.yml)

---

## ‚ö° –ù–û–í–û–ï: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏! (v2.0)

üéâ **–°–∫—Ä–∏–ø—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!**

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚ö° **6.5x –±—ã—Å—Ç—Ä–µ–µ** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ 100 –¥–µ–ª: 55 —Å–µ–∫ ‚Üí 8.5 —Å–µ–∫
- üìâ **10x –º–µ–Ω—å—à–µ API –≤—ã–∑–æ–≤–æ–≤** - 1600 ‚Üí 160 –≤—ã–∑–æ–≤–æ–≤
- üõ°Ô∏è **100% –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∫–≤–æ—Ç
- üìß **HTML email –æ—Ç—á—ë—Ç—ã** - –∫—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

### üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ `src/`:
- `Utils.gs` - —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞—Ç (10x –±—ã—Å—Ç—Ä–µ–µ)
- `CaseManager.gs` - batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ (6.7x –±—ã—Å—Ç—Ä–µ–µ)
- `CalendarManager.gs` - retry –ª–æ–≥–∏–∫–∞ (6x –±—ã—Å—Ç—Ä–µ–µ)
- `DeadlineChecker.gs` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–ª (10x –±—ã—Å—Ç—Ä–µ–µ)
- `ErrorHandler.gs` - **–ù–û–í–´–ô** –º–æ–¥—É–ª—å –¥–ª—è retry –ª–æ–≥–∏–∫–∏

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **[DEPLOY_INSTRUCTIONS.md](DEPLOY_INSTRUCTIONS.md)** - –±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –∑–∞ 10 –º–∏–Ω—É—Ç
- **[MIGRATION_GUIDE.md](MIGRATION_GUIDE.md)** - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å —Ç–µ—Å—Ç–∞–º–∏
- **[CODE_REVIEW.md](CODE_REVIEW.md)** - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π
- **[README_IMPROVEMENTS.md](README_IMPROVEMENTS.md)** - –ø–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

**üöÄ –ù–∞—á–Ω–∏—Ç–µ —Å [DEPLOY_INSTRUCTIONS.md](DEPLOY_INSTRUCTIONS.md) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞!**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#–ª–æ–∫–∞–ª—å–Ω–∞—è-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [CI/CD](#cicd)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ö–æ–º–∞–Ω–¥—ã](#–∫–æ–º–∞–Ω–¥—ã)
- [Best Practices](#best-practices)

---

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç Google Apps Script –∫–æ–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ Legal AI. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å GitHub –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ CI/CD.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üìä –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ Google Sheets
- üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
- üìß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- üé® –ö–∞—Å—Ç–æ–º–Ω–æ–µ –º–µ–Ω—é –≤ Google Sheets

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Google Apps Script
- clasp (Command Line Apps Script Projects)
- GitHub Actions –¥–ª—è CI/CD
- ESLint –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+ ([—Å–∫–∞—á–∞—Ç—å](https://nodejs.org/))
- npm 9+
- Google –∞–∫–∫–∞—É–Ω—Ç —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ç–∞–±–ª–∏—Ü–µ
- GitHub –∞–∫–∫–∞—É–Ω—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone https://github.com/Andrew821667/legal-ai-sheets-scripts.git
cd legal-ai-sheets-scripts
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É:**

```bash
chmod +x scripts/setup-local.sh
./scripts/setup-local.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç Node.js –∏ npm
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç clasp
- ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Google
- ‚úÖ –°–∫–∞—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –∏–∑ Google Sheets

3. **–ì–æ—Ç–æ–≤–æ!** –ú–æ–∂–µ—Ç–µ –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É üéâ

---

## üíª –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ setup —Å–∫—Ä–∏–ø—Ç)

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ clasp

```bash
# –ì–ª–æ–±–∞–ª—å–Ω–æ
npm install -g @google/clasp

# –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ npx)
npm install --save-dev @google/clasp
```

#### 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Google

```bash
clasp login
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ credentials —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `~/.clasprc.json`.

#### 4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ Google Sheets

```bash
npm run pull
# –∏–ª–∏
clasp pull
```

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Workflow)

#### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥** –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/`
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**

```bash
npm run lint
```

3. **–ò—Å–ø—Ä–∞–≤–ª—è–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

```bash
npm run lint:fix
```

#### –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Sheets

```bash
# –û–±—ã—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
npm run push

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
npm run push:force
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
npm run watch
```

–§–∞–π–ª—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ Google Sheets –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏.

#### –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```bash
npm run open
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
npm run logs
```

---

## üîß CI/CD

### GitHub Actions Workflows

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –¥–≤—É–º—è workflows:

#### 1. **Test & Lint** (`.github/workflows/test.yml`)

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏:
- Pull Request –≤ `main` –∏–ª–∏ `develop`
- Push –≤ `main` –∏–ª–∏ `develop`

–í—ã–ø–æ–ª–Ω—è–µ—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É –∫–æ–¥–∞ (ESLint)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Prettier)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ clasp

#### 2. **Deploy to Production** (`.github/workflows/deploy.yml`)

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏:
- Push –≤ –≤–µ—Ç–∫—É `main`
- –°–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ–≥–∞ `v*`
- –†—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ (workflow_dispatch)

–í—ã–ø–æ–ª–Ω—è–µ—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –∫–æ–¥–∞ –≤ Google Apps Script
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ production

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–î–ª—è —Ä–∞–±–æ—Ç—ã CI/CD –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:

#### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å `.clasprc.json`

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `clasp login` –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:

```bash
cat ~/.clasprc.json
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–≤–µ—Å—å JSON** –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞.

#### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –≤ GitHub Secrets

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. Settings ‚Üí Secrets and variables ‚Üí Actions
3. –ù–∞–∂–º–∏—Ç–µ **New repository secret**
4. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç:
   - **Name:** `CLASPRC_JSON`
   - **Value:** —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `~/.clasprc.json`

#### –®–∞–≥ 3 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): Deployment ID

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç:

```bash
clasp deployments
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Deployment ID –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç:
- **Name:** `DEPLOYMENT_ID`
- **Value:** ID –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –≤—Ä—É—á–Ω—É—é:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** –Ω–∞ GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ **Deploy to Production**
3. –ù–∞–∂–º–∏—Ç–µ **Run workflow**
4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
legal-ai-sheets-scripts/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ deploy.yml          # –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –Ω–∞ production
‚îÇ       ‚îî‚îÄ‚îÄ test.yml            # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ª–∏–Ω—Ç–∏–Ω–≥
‚îÇ
‚îú‚îÄ‚îÄ src/                        # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Code.gs                 # –ì–ª–∞–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ–Ω—é
‚îÇ   ‚îî‚îÄ‚îÄ Utils.gs                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ setup-local.sh          # –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ .clasp.json                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è clasp (Script ID)
‚îú‚îÄ‚îÄ .claspignore                # –§–∞–π–ª—ã, –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ –∏–∑ –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ .gitignore                  # Git ignore
‚îú‚îÄ‚îÄ .eslintrc.json              # ESLint –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .prettierrc.json            # Prettier –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ package.json                # npm –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

#### `.clasp.json`

–°–æ–¥–µ—Ä–∂–∏—Ç Script ID –≤–∞—à–µ–≥–æ Google Apps Script –ø—Ä–æ–µ–∫—Ç–∞:

```json
{
  "scriptId": "YOUR_SCRIPT_ID",
  "rootDir": "./src",
  "fileExtension": "gs"
}
```

#### `src/Code.gs`

–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `onOpen()` - —Å–æ–∑–¥–∞–µ—Ç –º–µ–Ω—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ç–∞–±–ª–∏—Ü—ã
- `refreshData()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `exportToPDF()` - —ç–∫—Å–ø–æ—Ä—Ç –≤ PDF
- `sendReport()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤

#### `src/Utils.gs`

–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –†–∞–±–æ—Ç–∞ —Å –ª–∏—Å—Ç–∞–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- HTTP –∑–∞–ø—Ä–æ—Å—ã
- –†–∞–±–æ—Ç–∞ —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ —Å–∫—Ä–∏–ø—Ç–∞

---

## üéØ –ö–æ–º–∞–Ω–¥—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `npm run pull` | –°–∫–∞—á–∞—Ç—å –∫–æ–¥ –∏–∑ Google Sheets |
| `npm run push` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–¥ –≤ Google Sheets |
| `npm run push:force` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ |
| `npm run watch` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ |
| `npm run open` | –û—Ç–∫—Ä—ã—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ |
| `npm run logs` | –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `npm run lint` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ |
| `npm run lint:fix` | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| `npm run format` | –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ |
| `npm run format:check` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `npm run version` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é |
| `npm run deploy` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å |

---

## ‚ú® Best Practices

### 1. –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–†–∞–∑–¥–µ–ª—è–π—Ç–µ –∫–æ–¥ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏:

```javascript
// ‚ùå –ü–ª–æ—Ö–æ: –≤—Å—ë –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
function onOpen() {
  // 500 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞...
}

// ‚úÖ –•–æ—Ä–æ—à–æ: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ–∞–π–ª–∞–º
// Code.gs - –≥–ª–∞–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
// Utils.gs - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
// API.gs - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ
const CONFIG = Object.freeze({
  SHEET_NAMES: {
    MAIN: '–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
    ARCHIVE: '–ê—Ä—Ö–∏–≤'
  }
});

const sheet = getSheetByName(CONFIG.SHEET_NAMES.MAIN);
```

### 3. Batch –æ–ø–µ—Ä–∞—Ü–∏–∏

```javascript
// ‚ùå –ü–ª–æ—Ö–æ: –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Sheets API
for (let i = 1; i <= 100; i++) {
  sheet.getRange('A' + i).setValue(i);
}

// ‚úÖ –•–æ—Ä–æ—à–æ: –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
const values = Array.from({ length: 100 }, (_, i) => [i + 1]);
sheet.getRange('A1:A100').setValues(values);
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ
try {
  const data = fetchData();
  processData(data);
} catch (error) {
  Logger.log('Error: ' + error.message);
  showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö');
}
```

### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ª–∏—Å—Ç
function logToSheet(level, message, data) {
  const logSheet = getSheetByName('–õ–æ–≥–∏');
  logSheet.appendRow([new Date(), level, message, JSON.stringify(data)]);
}
```

### 6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Properties Service –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ
function getApiKey() {
  return PropertiesService.getScriptProperties().getProperty('API_KEY');
}

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∏–ª–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é
function setupConfig() {
  PropertiesService.getScriptProperties().setProperty('API_KEY', 'your-key');
}
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git:

- ‚ùå API –∫–ª—é—á–∏
- ‚ùå –ü–∞—Ä–æ–ª–∏
- ‚ùå –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚ùå `.clasprc.json` (–ª–æ–∫–∞–ª—å–Ω—ã–µ credentials)

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

- ‚úÖ Properties Service –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ GitHub Secrets –¥–ª—è CI/CD
- ‚úÖ Environment variables

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "You are not logged in"

```bash
clasp login
```

### –û—à–∏–±–∫–∞: "Permission denied"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ –∏ —Å–∫—Ä–∏–ø—Ç—É.

### –û—à–∏–±–∫–∞: "Script ID not found"

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.clasp.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Script ID:

```bash
cat .clasp.json
```

### CI/CD –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Secrets (Settings ‚Üí Secrets)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `CLASPRC_JSON` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π JSON
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Google Apps Script

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Google Apps Script Documentation](https://developers.google.com/apps-script)
- [clasp Documentation](https://github.com/google/clasp)
- [Apps Script Best Practices](https://developers.google.com/apps-script/guides/support/best-practices)
- [Apps Script Samples](https://github.com/googleworkspace/apps-script-samples)

---

## üë§ –ê–≤—Ç–æ—Ä

**Andrew Popov**

- Email: a.popov.gv@gmail.com
- GitHub: [@Andrew821667](https://github.com/Andrew821667)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –±–∞–≥ –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ:

1. –°–æ–∑–¥–∞–π—Ç–µ Issue
2. –ò–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ Pull Request

–ë—É–¥—É —Ä–∞–¥ –ª—é–±–æ–π –ø–æ–º–æ—â–∏! üôå
