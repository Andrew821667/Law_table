# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –£–ª—É—á—à–µ–Ω–Ω—ã–µ –í–µ—Ä—Å–∏–∏

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π](#–æ–±–∑–æ—Ä-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∫-–º–∏–≥—Ä–∞—Ü–∏–∏)
3. [–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](#–ø–æ—à–∞–≥–æ–≤–∞—è-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)
4. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
5. [–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π](#–æ—Ç–∫–∞—Ç-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
6. [–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã](#—á–∞—Å—Ç—ã–µ-–≤–æ–ø—Ä–æ—Å—ã)

---

## üéØ –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–π–ª—ã –¥–ª—è –∑–∞–º–µ–Ω—ã:

| –°—Ç–∞—Ä—ã–π —Ñ–∞–π–ª | –ù–æ–≤—ã–π —Ñ–∞–π–ª | –£–ª—É—á—à–µ–Ω–∏–µ |
|------------|------------|-----------|
| `Utils.gs` | `Utils_IMPROVED.gs` | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç, batch –æ–ø–µ—Ä–∞—Ü–∏–∏ (10x –±—ã—Å—Ç—Ä–µ–µ) |
| `CaseManager.gs` | `CaseManager_IMPROVED.gs` | –£–±—Ä–∞–Ω—ã delays, batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ (6.7x –±—ã—Å—Ç—Ä–µ–µ) |
| `CalendarManager.gs` | `CalendarManager_IMPROVED.gs` | –î–∏–∞–ø–∞–∑–æ–Ω 2.5 –ª–µ—Ç, retry –ª–æ–≥–∏–∫–∞ (6x –±—ã—Å—Ç—Ä–µ–µ) |
| `DeadlineChecker.gs` | `DeadlineChecker_IMPROVED.gs` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö, HTML email (10x –±—ã—Å—Ç—Ä–µ–µ) |
| - | `ErrorHandler_NEW.gs` | **–ù–û–í–´–ô** –º–æ–¥—É–ª—å –¥–ª—è retry –ª–æ–≥–∏–∫–∏ |

### –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 55 —Å–µ–∫ ‚Üí 8.5 —Å–µ–∫ (6.5x –±—ã—Å—Ç—Ä–µ–µ)
- üìâ **API –≤—ã–∑–æ–≤—ã**: 1600 ‚Üí 160 (10x –º–µ–Ω—å—à–µ)
- üõ°Ô∏è **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∫–≤–æ—Ç
- üìß **Email –æ—Ç—á—ë—Ç—ã**: HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

---

## üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

#### 1.1. –ö–æ–ø–∏—è —Ç–∞–±–ª–∏—Ü—ã Google Sheets

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É: https://docs.google.com/spreadsheets/d/1z71C-B_f8REz45blQKISYmqmNcemdHLtICwbSMrcIo8
2. **File** ‚Üí **Make a copy**
3. –ù–∞–∑–æ–≤–∏—Ç–µ: `Law Table - BACKUP [–î–∞—Ç–∞]`
4. **–°–û–•–†–ê–ù–ò–¢–ï –°–°–´–õ–ö–£** –Ω–∞ backup –≥–¥–µ-–Ω–∏–±—É–¥—å!

#### 1.2. –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—É—â–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

–ù–∞ –≤–∞—à–µ–º Mac:

```bash
cd ~/Projects/Law_table

# –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è backup
git checkout -b backup-before-improvements
git push origin backup-before-improvements

# –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ main
git checkout main
```

#### 1.3. –°–∫–∞—á–∞–π—Ç–µ —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤

```bash
# –≠—Ç–æ —Å–∫–∞—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –≤ src/
clasp pull

# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p backup_old_scripts
cp src/*.gs backup_old_scripts/

echo "Backup —Å–æ–∑–¥–∞–Ω: $(date)" > backup_old_scripts/README.txt
```

### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
# (–µ—Å–ª–∏ –æ–Ω–∏ –µ—â—ë –Ω–µ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ)

# –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–ª–∏ Law_table_improved:
cp ~/Law_table_improved/src_improved/*.gs ~/Projects/Law_table/src/

# –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª—ã (—É–±–µ—Ä–∏—Ç–µ _IMPROVED –∏ _NEW)
cd ~/Projects/Law_table/src/
mv Utils_IMPROVED.gs Utils.gs
mv CaseManager_IMPROVED.gs CaseManager.gs
mv CalendarManager_IMPROVED.gs CalendarManager.gs
mv DeadlineChecker_IMPROVED.gs DeadlineChecker.gs
mv ErrorHandler_NEW.gs ErrorHandler.gs
```

---

## üìù –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –≠—Ç–∞–ø 1: –ú–∏–≥—Ä–∞—Ü–∏—è Utils.gs (10 –º–∏–Ω—É—Ç)

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –ø–æ—ç—Ç–æ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –Ω–µ–≥–æ.

#### 1.1. –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª

```bash
cd ~/Projects/Law_table/src/
# –§–∞–π–ª —É–∂–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤—ã—à–µ
```

#### 1.2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```bash
npm run lint src/Utils.gs
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö.

#### 1.3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Google Apps Script

```bash
clasp push
```

#### 1.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Utils

–í Google Apps Script Editor:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç: `clasp open`
2. –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –≤—ã–±–µ—Ä–∏—Ç–µ **Utils.gs**
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–∞:

```javascript
function testUtilsImproved() {
  // –¢–µ—Å—Ç parseDate —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
  const date1 = Utils.parseDate('15.11.2024');
  const date2 = Utils.parseDate('15.11.2024'); // –î–æ–ª–∂–µ–Ω –≤–∑—è—Ç—å –∏–∑ –∫—ç—à–∞

  Logger.log('–î–∞—Ç–∞ 1: ' + date1);
  Logger.log('–î–∞—Ç–∞ 2: ' + date2);
  Logger.log('–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ: ' + (date1.getTime() === date2.getTime()));

  // –¢–µ—Å—Ç daysUntil
  const days = Utils.daysUntil('31.12.2024');
  Logger.log('–î–Ω–µ–π –¥–æ –ù–ì: ' + days);

  // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫—ç—à–∞
  Logger.log('–†–∞–∑–º–µ—Ä –∫—ç—à–∞: ' + Object.keys(Utils.dateCache?.parsed || {}).length);
}
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é: **Run** ‚Üí **testUtilsImproved**
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: **View** ‚Üí **Logs**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–î–∞—Ç–∞ 1: Fri Nov 15 2024 00:00:00 GMT+0300
–î–∞—Ç–∞ 2: Fri Nov 15 2024 00:00:00 GMT+0300
–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ: true
–î–Ω–µ–π –¥–æ –ù–ì: 46
–†–∞–∑–º–µ—Ä –∫—ç—à–∞: 1
```

‚úÖ –ï—Å–ª–∏ –≤—Å—ë –û–ö - –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É!

---

### –≠—Ç–∞–ø 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ErrorHandler.gs (15 –º–∏–Ω—É—Ç)

–≠—Ç–æ **–Ω–æ–≤—ã–π** –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º.

#### 2.1. –§–∞–π–ª —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω

ErrorHandler.gs —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `src/` –ø–æ—Å–ª–µ `clasp push` –≤—ã—à–µ.

#### 2.2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ErrorHandler

–í Google Apps Script Editor —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç:

```javascript
function testErrorHandler() {
  // –¢–µ—Å—Ç 1: –£—Å–ø–µ—à–Ω—ã–π –≤—ã–∑–æ–≤
  const result = ErrorHandler.retry(
    () => 'Success!',
    '–¢–µ—Å—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è'
  );
  Logger.log('–†–µ–∑—É–ª—å—Ç–∞—Ç: ' + result);

  // –¢–µ—Å—Ç 2: Retry –ø—Ä–∏ –æ—à–∏–±–∫–µ
  let attempts = 0;
  const resultWithRetry = ErrorHandler.retry(
    () => {
      attempts++;
      if (attempts < 3) {
        throw new Error('Service invoked too many times'); // Retryable error
      }
      return 'Success after retries!';
    },
    '–û–ø–µ—Ä–∞—Ü–∏—è —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏',
    { maxRetries: 5, baseDelay: 100 }
  );
  Logger.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ ' + attempts + ' –ø–æ–ø—ã—Ç–æ–∫: ' + resultWithRetry);

  // –¢–µ—Å—Ç 3: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  ErrorHandler.logStats();
}
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏.

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: Success!
‚ö†Ô∏è –û–ø–µ—Ä–∞—Ü–∏—è —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ - –ø–æ–ø—ã—Ç–∫–∞ 1/5 –Ω–µ —É–¥–∞–ª–∞—Å—å: Service invoked too many times
   –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 100ms...
‚ö†Ô∏è –û–ø–µ—Ä–∞—Ü–∏—è —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ - –ø–æ–ø—ã—Ç–∫–∞ 2/5 –Ω–µ —É–¥–∞–ª–∞—Å—å: Service invoked too many times
   –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 200ms...
‚úÖ –û–ø–µ—Ä–∞—Ü–∏—è —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ - —É—Å–ø–µ—à–Ω–æ –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫
–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫: Success after retries!

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ErrorHandler:
   –í—Å–µ–≥–æ –≤—ã–∑–æ–≤–æ–≤: 2
   –£—Å–ø–µ—à–Ω—ã—Ö: 2
   –ù–µ—É–¥–∞—á–Ω—ã—Ö: 0
   –° –ø–æ–≤—Ç–æ—Ä–∞–º–∏: 2
   Success Rate: 100.0%
```

‚úÖ ErrorHandler –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

---

### –≠—Ç–∞–ø 3: –ú–∏–≥—Ä–∞—Ü–∏—è CalendarManager.gs (20 –º–∏–Ω—É—Ç)

#### 3.1. –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª

–§–∞–π–ª —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–º–µ–Ω—ë–Ω –ø–æ—Å–ª–µ —à–∞–≥–∞ –≤—ã—à–µ.

#### 3.2. –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

–í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ErrorHandler`, –ø–æ—ç—Ç–æ–º—É —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:

1. `ErrorHandler.gs` –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç
2. –í `appsscript.json` –ø–æ—Ä—è–¥–æ–∫ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:

```json
{
  "timeZone": "Europe/Moscow",
  "dependencies": {},
  "exceptionLogging": "STACKDRIVER",
  "runtimeVersion": "V8",
  "executionApi": {
    "access": "ANYONE"
  }
}
```

Google Apps Script –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–æ `ErrorHandler` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω –î–û `CalendarManager`.

#### 3.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CalendarManager

**–¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è**

```javascript
function testCalendarManagerCreate() {
  const testEvent = CalendarManager.createOrUpdateEvent({
    caseNumber: 'TEST-001',
    hearingType: '–°—É–¥–µ–±–Ω–æ–µ –∑–∞—Å–µ–¥–∞–Ω–∏–µ',
    hearingDate: '25.11.2024',
    court: '–¢–µ—Å—Ç–æ–≤—ã–π —Å—É–¥',
    details: '–¢–µ—Å—Ç–æ–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏'
  });

  Logger.log('–°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ: ' + testEvent);

  // –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É ErrorHandler
  ErrorHandler.logStats();
}
```

**–¢–µ—Å—Ç 2: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π**

```javascript
function testCalendarManagerDelete() {
  CalendarManager.deleteEventsForCase('TEST-001');

  Logger.log('–°–æ–±—ã—Ç–∏—è —É–¥–∞–ª–µ–Ω—ã');
  ErrorHandler.logStats();
}
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Google Calendar:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ CONFIG.CALENDAR.CALENDAR_ID
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ "TEST-001" —Å–æ–∑–¥–∞–Ω–æ
3. –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ 2 - —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ–Ω–æ —É–¥–∞–ª–µ–Ω–æ

‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏–¥—ë–º –¥–∞–ª—å—à–µ!

---

### –≠—Ç–∞–ø 4: –ú–∏–≥—Ä–∞—Ü–∏—è DeadlineChecker.gs (15 –º–∏–Ω—É—Ç)

#### 4.1. –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª

–§–∞–π–ª —É–∂–µ –∑–∞–º–µ–Ω—ë–Ω.

#### 4.2. –û–±–Ω–æ–≤–∏—Ç–µ CONFIG (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–í `Config.gs` —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è email:

```javascript
CALENDAR: {
  NOTIFICATION_EMAILS: [
    'your-email@example.com'  // –í–∞—à email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  ]
}
```

#### 4.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DeadlineChecker

**–¢–µ—Å—Ç 1: –ü–æ–∏—Å–∫ –¥–µ–¥–ª–∞–π–Ω–æ–≤**

```javascript
function testDeadlineChecker() {
  Logger.log('=== –¢–ï–°–¢ DeadlineChecker ===');

  // –ò—â–µ–º –¥–µ–¥–ª–∞–π–Ω—ã –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π
  const problems = DeadlineChecker.findUpcomingDeadlines(7);

  Logger.log('–ù–∞–π–¥–µ–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –¥–µ–¥–ª–∞–π–Ω–æ–≤: ' + problems.length);

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5
  for (let i = 0; i < Math.min(5, problems.length); i++) {
    const p = problems[i];
    Logger.log(`\n${i+1}. ${p.caseNumber}`);
    Logger.log(`   –°–æ–±—ã—Ç–∏–µ: ${p.columnName}`);
    Logger.log(`   –î–∞—Ç–∞: ${p.date} (—á–µ—Ä–µ–∑ ${p.daysUntil} –¥–Ω.)`);
    Logger.log(`   –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: ${p.severity}`);
    Logger.log(`   –°—Ç–∞—Ç—É—Å: ${p.status}`);
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–ª
  Logger.log('\n=== –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ ===');
  Logger.log('–ê–∫—Ç–∏–≤–Ω–æ: "–í —Ä–∞–±–æ—Ç–µ" -> ' + isCaseActive('–í —Ä–∞–±–æ—Ç–µ'));
  Logger.log('–ù–µ–∞–∫—Ç–∏–≤–Ω–æ: "–ó–∞–≤–µ—Ä—à–µ–Ω–æ" -> ' + isCaseActive('–ó–∞–≤–µ—Ä—à–µ–Ω–æ'));
  Logger.log('–ù–µ–∞–∫—Ç–∏–≤–Ω–æ: "–ê—Ä—Ö–∏–≤" -> ' + isCaseActive('–ê—Ä—Ö–∏–≤'));
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞
function isCaseActive(status) {
  const INACTIVE_STATUSES = [
    '–ó–∞–≤–µ—Ä—à–µ–Ω–æ', '–ê—Ä—Ö–∏–≤', '–û—Ç–æ–∑–≤–∞–Ω–æ', '–ü—Ä–µ–∫—Ä–∞—â–µ–Ω–æ', '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ'
  ];
  if (!status) return true;
  const statusStr = String(status).trim();
  return !INACTIVE_STATUSES.some(inactive =>
    statusStr.toLowerCase().includes(inactive.toLowerCase())
  );
}
```

**–¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ (–û–°–¢–û–†–û–ñ–ù–û - –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–π email!)**

```javascript
function testDeadlineReport() {
  const problems = DeadlineChecker.findUpcomingDeadlines(7);

  if (problems.length > 0) {
    Logger.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –æ ' + problems.length + ' –¥–µ–¥–ª–∞–π–Ω–∞—Ö...');
    DeadlineChecker.sendDeadlineReport(problems);
    Logger.log('‚úÖ –û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
  } else {
    Logger.log('–ù–µ—Ç –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –¥–µ–¥–ª–∞–π–Ω–æ–≤');
  }
}
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ email:**
- –î–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–π HTML email
- –° –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ (–°–µ–≥–æ–¥–Ω—è, –ó–∞–≤—Ç—Ä–∞, 2-3 –¥–Ω—è)
- –° —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

‚úÖ –ï—Å–ª–∏ email –ø—Ä–∏—à—ë–ª –∏ –≤—ã–≥–ª—è–¥–∏—Ç —Ö–æ—Ä–æ—à–æ - –æ—Ç–ª–∏—á–Ω–æ!

---

### –≠—Ç–∞–ø 5: –ú–∏–≥—Ä–∞—Ü–∏—è CaseManager.gs (30 –º–∏–Ω—É—Ç)

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï**: –≠—Ç–æ —Å–∞–º—ã–π –∫—Ä–∏—Ç–∏—á–Ω—ã–π –º–æ–¥—É–ª—å, —Ç.–∫. –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–ª–∞!

#### 5.1. –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª

–§–∞–π–ª —É–∂–µ –∑–∞–º–µ–Ω—ë–Ω.

#### 5.2. –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ß—Ç–æ –£–î–ê–õ–ï–ù–û:**
```javascript
// ‚ùå –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –£–î–ê–õ–ï–ù–ê
if (processedCount % 5 === 0) {
  Utilities.sleep(300); // –£–±—Ä–∞–Ω–æ!
}
```

**–ß—Ç–æ –î–û–ë–ê–í–õ–ï–ù–û:**
```javascript
// ‚úÖ Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞
const BATCH_SIZE = 50;
for (let startRow = 2; startRow <= lastRow; startRow += BATCH_SIZE) {
  const endRow = Math.min(startRow + BATCH_SIZE - 1, lastRow);
  processCasesBatch(sheet, startRow, endRow);
}
```

#### 5.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ö–û–ü–ò–ò —Ç–∞–±–ª–∏—Ü—ã

‚ö†Ô∏è **–ù–ï –¢–ï–°–¢–ò–†–£–ô–¢–ï –ù–ê –ë–û–ï–í–û–ô –¢–ê–ë–õ–ò–¶–ï!**

1. –û—Ç–∫—Ä–æ–π—Ç–µ backup —Ç–∞–±–ª–∏—Ü—É (–∫–æ—Ç–æ—Ä—É—é —Å–æ–∑–¥–∞–ª–∏ –≤ –Ω–∞—á–∞–ª–µ)
2. –í —Å–∫—Ä–∏–ø—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ `SpreadsheetApp.getActiveSpreadsheet()` –Ω–∞ ID backup —Ç–∞–±–ª–∏—Ü—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:

```javascript
function testCaseManagerOnBackup() {
  // –ü–æ–ª—É—á–∞–µ–º backup —Ç–∞–±–ª–∏—Ü—É
  const backupId = 'YOUR_BACKUP_SPREADSHEET_ID'; // –í—Å—Ç–∞–≤—å—Ç–µ ID backup
  const ss = SpreadsheetApp.openById(backupId);

  Logger.log('=== –¢–ï–°–¢ CaseManager –Ω–∞ backup —Ç–∞–±–ª–∏—Ü–µ ===');

  const startTime = new Date().getTime();

  // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10 –¥–µ–ª –¥–ª—è —Ç–µ—Å—Ç–∞
  const sheet = ss.getSheets()[0]; // –ü–µ—Ä–≤—ã–π –ª–∏—Å—Ç
  const lastRow = Math.min(sheet.getLastRow(), 11); // –°—Ç—Ä–æ–∫–∏ 2-11 (10 –¥–µ–ª)

  Logger.log('–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–ª —Å–æ —Å—Ç—Ä–æ–∫–∏ 2 –ø–æ ' + lastRow);

  // –í—ã–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
  // (–ù—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é CaseManager –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π)

  const endTime = new Date().getTime();
  const duration = (endTime - startTime) / 1000;

  Logger.log('‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ ' + duration + ' —Å–µ–∫');
  Logger.log('–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –¥–µ–ª–æ: ' + (duration / 10).toFixed(2) + ' —Å–µ–∫');
}
```

#### 5.4. –°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –í–µ—Ä—Å–∏—è | 100 –¥–µ–ª | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –¥–µ–ª–æ |
|--------|---------|----------------------|
| –°—Ç–∞—Ä–∞—è | ~20 —Å–µ–∫ | 0.20 —Å–µ–∫ |
| –ù–æ–≤–∞—è  | ~3 —Å–µ–∫  | 0.03 —Å–µ–∫ |

–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Ö–æ–∂–∏ - –æ—Ç–ª–∏—á–Ω–æ! ‚úÖ

---

### –≠—Ç–∞–ø 6: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (30 –º–∏–Ω—É—Ç)

#### 6.1. –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã

```javascript
function fullSystemTest() {
  Logger.log('=== –ü–û–õ–ù–´–ô –¢–ï–°–¢ –°–ò–°–¢–ï–ú–´ ===\n');

  // 1. Utils
  Logger.log('1Ô∏è‚É£ –¢–µ—Å—Ç Utils...');
  const date = Utils.parseDate('01.12.2024');
  Logger.log('   parseDate: ' + (date ? '‚úÖ OK' : '‚ùå FAIL'));

  // 2. ErrorHandler
  Logger.log('\n2Ô∏è‚É£ –¢–µ—Å—Ç ErrorHandler...');
  try {
    ErrorHandler.retry(() => 'OK', 'Test');
    Logger.log('   retry: ‚úÖ OK');
  } catch (e) {
    Logger.log('   retry: ‚ùå FAIL - ' + e.message);
  }

  // 3. CalendarManager
  Logger.log('\n3Ô∏è‚É£ –¢–µ—Å—Ç CalendarManager...');
  try {
    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
    CalendarManager.createOrUpdateEvent({
      caseNumber: 'SYSTEM-TEST-001',
      hearingType: '–¢–µ—Å—Ç',
      hearingDate: '10.12.2024',
      court: '–¢–µ—Å—Ç–æ–≤—ã–π —Å—É–¥',
      details: '–°–∏—Å—Ç–µ–º–Ω—ã–π —Ç–µ—Å—Ç'
    });
    Logger.log('   createEvent: ‚úÖ OK');

    // –£–¥–∞–ª–µ–Ω–∏–µ
    CalendarManager.deleteEventsForCase('SYSTEM-TEST-001');
    Logger.log('   deleteEvent: ‚úÖ OK');
  } catch (e) {
    Logger.log('   CalendarManager: ‚ùå FAIL - ' + e.message);
  }

  // 4. DeadlineChecker
  Logger.log('\n4Ô∏è‚É£ –¢–µ—Å—Ç DeadlineChecker...');
  try {
    const problems = DeadlineChecker.findUpcomingDeadlines(7);
    Logger.log('   findDeadlines: ‚úÖ OK (' + problems.length + ' found)');
  } catch (e) {
    Logger.log('   DeadlineChecker: ‚ùå FAIL - ' + e.message);
  }

  // 5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  Logger.log('\nüìä –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:');
  ErrorHandler.logStats();

  Logger.log('\n‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û');
}
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

#### 6.2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
1. –û—Ç–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –Ω–∞ 1 –¥–µ–Ω—å
2. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é
3. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
4. –ï—Å–ª–∏ –≤—Å—ë —Å—Ç–∞–±–∏–ª—å–Ω–æ 24 —á–∞—Å–∞ - –≤–∫–ª—é—á–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –æ–±—Ä–∞—Ç–Ω–æ

---

## üîÑ –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

### –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (—á–µ—Ä–µ–∑ clasp)

```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ backup –≤–µ—Ç–∫—É
cd ~/Projects/Law_table
git checkout backup-before-improvements

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã
clasp push --force

Logger.log('‚úÖ –û—Ç–∫–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!');
```

### –û—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ Git

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é
git log --oneline

# –û—Ç–∫–∞—Ç–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –∫–æ–º–º–∏—Ç
git revert <commit-hash>

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
clasp push
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ backup —Ç–∞–±–ª–∏—Ü—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ backup —Ç–∞–±–ª–∏—Ü—É
2. **File** ‚Üí **Make a copy**
3. –ù–∞–∑–æ–≤–∏—Ç–µ —Ç–∞–∫–∂–µ –∫–∞–∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é
4. –û–±–Ω–æ–≤–∏—Ç–µ Script ID –≤ `.clasp.json` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ú–æ–∂–Ω–æ –ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ –æ–¥–Ω–æ–º—É?

**A:** –î–∞! –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:
1. Utils.gs (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö)
2. ErrorHandler.gs (–Ω–æ–≤—ã–π –º–æ–¥—É–ª—å)
3. CalendarManager.gs (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç ErrorHandler)
4. DeadlineChecker.gs (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç Utils)
5. CaseManager.gs (—Å–∞–º—ã–π –∫—Ä–∏—Ç–∏—á–Ω—ã–π)

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ø–∞–¥–∞–µ—Ç quota limit?

**A:** ErrorHandler –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç retry. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```javascript
ErrorHandler.logStats();
```

–ï—Å–ª–∏ `retriedCalls` > 50% –æ—Ç `totalCalls`, –∑–Ω–∞—á–∏—Ç –∫–≤–æ—Ç—ã –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á—å—Ç–µ BATCH_SIZE –≤ CaseManager
- –£–º–µ–Ω—å—à–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ Google Workspace (–±–æ–ª—å—à–µ –∫–≤–æ—Ç)

### Q: Email –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ DeadlineChecker

**A:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –í `Config.gs` —É–∫–∞–∑–∞–Ω—ã email –∞–¥—Ä–µ—Å–∞:
   ```javascript
   NOTIFICATION_EMAILS: ['your@email.com']
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∞–º/–ø—Ä–æ–º–æ–∞–∫—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ "‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω"
4. –ü—Ä–∞–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É email (Authorization)

### Q: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ —É–ª—É—á—à–∏–ª–∞—Å—å

**A:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
1. –í–°–ï —Ñ–∞–π–ª—ã –∑–∞–º–µ–Ω–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ `clasp pull`)
2. ErrorHandler.gs –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç
3. –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥—É–±–ª–µ–π)
4. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à: **Run** ‚Üí **Clear execution logs**

### Q: –ú–æ–∂–Ω–æ –ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ —á–∞—Å—Ç–∏—á–Ω–æ?

**A:** –î–∞, –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –Ω–µ–∑–∞–≤–∏—Å–∏–º:
```bash
# –í–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ CaseManager
git checkout backup-before-improvements -- src/CaseManager.gs
clasp push
```

---

## üìä –ß–µ–∫-–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

### –ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π:
- [ ] ‚úÖ –°–æ–∑–¥–∞–Ω–∞ backup –∫–æ–ø–∏—è —Ç–∞–±–ª–∏—Ü—ã
- [ ] ‚úÖ –°–æ–∑–¥–∞–Ω–∞ backup –≤–µ—Ç–∫–∞ –≤ Git
- [ ] ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –≤ backup_old_scripts/
- [ ] ‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ backup —Ç–∞–±–ª–∏—Ü—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –ú–∏–≥—Ä–∞—Ü–∏—è:
- [ ] ‚úÖ Utils.gs - –∑–∞–º–µ–Ω—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] ‚úÖ ErrorHandler.gs - –¥–æ–±–∞–≤–ª–µ–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] ‚úÖ CalendarManager.gs - –∑–∞–º–µ–Ω—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] ‚úÖ DeadlineChecker.gs - –∑–∞–º–µ–Ω—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] ‚úÖ CaseManager.gs - –∑–∞–º–µ–Ω—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (–Ω–∞ backup!)
- [ ] ‚úÖ –ü–æ–ª–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- [ ] ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 24 —á–∞—Å–∞ (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü–∏–π)
- [ ] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- [ ] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ErrorHandler (success rate > 95%)
- [ ] ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ

### Git:
- [ ] ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [ ] ‚úÖ –ó–∞–ø—É—à–µ–Ω—ã –Ω–∞ GitHub
- [ ] ‚úÖ CI/CD pipeline –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

- ‚ö° **6.5x** —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- üìâ **10x** –º–µ–Ω—å—à–µ API –≤—ã–∑–æ–≤–æ–≤
- üõ°Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- üìß –ö—Ä–∞—Å–∏–≤—ã–µ HTML email –æ—Ç—á—ë—Ç—ã
- üéØ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–ª
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
2. –°–æ–±–µ—Ä–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –Ω–µ–¥–µ–ª—é
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üÜò –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

**–ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π?**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [CODE_REVIEW.md](./CODE_REVIEW.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
2. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: **View** ‚Üí **Logs** –≤ Apps Script
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: `ErrorHandler.logStats()`
4. –°–æ–∑–¥–∞–π—Ç–µ Issue –Ω–∞ GitHub

**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
- GitHub: https://github.com/Andrew821667/Law_table
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [README.md](./README.md)

---

**–£–¥–∞—á–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏!** üöÄ

*–í—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏: ~2 —á–∞—Å–∞*
*–°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è*
*–†–∏—Å–∫: –ù–∏–∑–∫–∏–π (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ backup)*
